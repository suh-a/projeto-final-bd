CREATE DATABASE work_flow_db;

USE work_flow_db;

CREATE TABLE usuarios(
    id_usuarios INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(45)NOT NULL,
    senha VARCHAR(8) NOT NULL,
    telefone VARCHAR(20) NOT NULL,
    cpf VARCHAR(14) NOT NULL,
    data_criacao DATETIME DEFAULT NOW()
);

CREATE TABLE notificacoes(
    id_notificacao INT AUTO_INCREMENT PRIMARY KEY,
    mensagem VARCHAR(45) NOT NULL,
    data_envio DATETIME NOT NULL DEFAULT NOW(),
    lida TINYINT NOT NULL,
    id_usuarios INT,
    FOREIGN KEY(id_usuarios)REFERENCES usuarios(id_usuarios)
);

CREATE TABLE areas(
    id_area INT AUTO_INCREMENT PRIMARY KEY,
    nome_area VARCHAR(45) NOT NULL	
);

CREATE TABLE profissionais(
    id_profissional INT AUTO_INCREMENT PRIMARY KEY,
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(45)NOT NULL,
    senha VARCHAR(8) NOT NULL,
    telefone VARCHAR(20) NOT NULL,
    cpf_cnpj VARCHAR(45)NOT NULL,
    descricao VARCHAR(200),
    nota_media DOUBLE,
    data_criacao DATETIME NOT NULL,
    id_area INT,
    FOREIGN KEY (id_area)REFERENCES areas(id_area)
);

CREATE TABLE disponibilidade(
    id_disponibilidade INT AUTO_INCREMENT PRIMARY KEY,
    dia_semana VARCHAR(45) NOT NULL,
    horario_inicio TIME NOT NULL,
    horario_fim TIME NOT NULL,
    id_profissional INT,
    FOREIGN KEY(id_profissional)REFERENCES profissionais(id_profissional)
);

CREATE TABLE avaliacoes(
    id_avaliacao INT AUTO_INCREMENT PRIMARY KEY,
    nota DOUBLE NOT NULL,
    comentario VARCHAR(45) NOT NULL,
    data_avaliacao DATETIME DEFAULT NOW(),
    id_usuarios INT,
    id_profissional INT,
    FOREIGN KEY(id_usuarios)REFERENCES usuarios(id_usuarios),
    FOREIGN KEY(id_profissional)REFERENCES profissionais(id_profissional)
);

CREATE TABLE favoritos(
    id_favorito INT AUTO_INCREMENT PRIMARY KEY,
    id_usuarios INT,
    id_profissional INT,
    FOREIGN KEY (id_usuarios)REFERENCES usuarios(id_usuarios),
    FOREIGN KEY (id_profissional)REFERENCES profissionais(id_profissional)
);

CREATE TABLE mensagens_chat(
    id_mensagem INT AUTO_INCREMENT PRIMARY KEY,
    mensagem TEXT NOT NULL,
    data_envio DATETIME DEFAULT NOW(),
    id_usuarios INT,
    id_profissional INT,
    FOREIGN KEY(id_usuarios) REFERENCES usuarios(id_usuarios),
    FOREIGN KEY(id_profissional) REFERENCES profissionais(id_profissional)
);

CREATE TABLE enderecos(
    id_endereco INT AUTO_INCREMENT PRIMARY KEY,
    rua VARCHAR(100) NOT NULL,
    numero VARCHAR(10) NOT NULL,
    complemento VARCHAR(50),
    bairro VARCHAR(50) NOT NULL,
    cidade VARCHAR(50) NOT NULL,
    estado VARCHAR(2) NOT NULL,
    cep VARCHAR(9) NOT NULL,
    id_usuarios INT,
    id_profissional INT,
    FOREIGN KEY(id_usuarios) REFERENCES usuarios(id_usuarios),
    FOREIGN KEY(id_profissional) REFERENCES profissionais(id_profissional)
);

CREATE TABLE categorias_servicos(
    id_categoria INT AUTO_INCREMENT PRIMARY KEY,
    nome_categoria VARCHAR(45) NOT NULL	  
);

CREATE TABLE servicos(
    id_servico INT AUTO_INCREMENT PRIMARY KEY,
    nome_servico VARCHAR(45) NOT NULL,
    descricao TEXT,
    preco_base DOUBLE NOT NULL,
    id_categoria INT,
    FOREIGN KEY(id_categoria) REFERENCES categorias_servicos(id_categoria)
);

CREATE TABLE solicitar_serv(
    id_solicitacao INT AUTO_INCREMENT PRIMARY KEY,
    data_solicitacao DATETIME NOT NULL DEFAULT NOW(),
    data_agendada DATETIME NOT NULL,
    stats ENUM('ACEITA','RECUSADA'),
    observacoes VARCHAR(100),
    id_usuarios INT,
    id_profissional INT,
    id_servico INT,
    FOREIGN KEY(id_usuarios)REFERENCES usuarios(id_usuarios),
    FOREIGN KEY(id_profissional)REFERENCES profissionais(id_profissional),
    FOREIGN KEY(id_servico)REFERENCES servicos(id_servico)
);

CREATE TABLE pagamentos(
    id_pagamento INT AUTO_INCREMENT PRIMARY KEY,
    valor DOUBLE NOT NULL,
    metodo_pagamento VARCHAR(45) NOT NULL,
    status_pagamento ENUM('PA','NP') NOT NULL,
    data_pagamento DATE DEFAULT NOW(),
    id_solicitacao INT,
    FOREIGN KEY(id_solicitacao)REFERENCES solicitar_serv(id_solicitacao)
);

CREATE TABLE historico_pag(
    id_historico INT AUTO_INCREMENT PRIMARY KEY,
    id_profissional INT,
    id_pagamento INT,
    FOREIGN KEY(id_profissional)REFERENCES profissionais(id_profissional),
    FOREIGN KEY(id_pagamento)REFERENCES pagamentos(id_pagamento)
);


INSERT INTO usuarios (nome, email, senha, telefone, cpf) VALUES
('João Silva', 'joao.silva@email.com', 'joao1267', '(11) 91234-5678', '123.456.789-00'),
('Maria Oliveira', 'maria.oliveira@email.com', '87654321', '(21) 98765-4321', '234.567.890-01'),
('Pedro Souza', 'pedro.souza@email.com', 'pas12351', '(31) 92345-6789', '345.678.901-02'),
('Ana Costa', 'ana.costa@email.com', 'anac5123', '(41) 93456-7890', '456.789.012-03'),
('Carlos Lima', 'carlos.lima@email.com', 'car126li', '(51) 94567-8901', '567.890.123-04'),
('Patrícia Pereira', 'patricia.pereira@email.com', 'abcde123', '(61) 95678-9012', '678.901.234-05'),
('Roberto Gomes', 'roberto.gomes@email.com', 'rober987', '(71) 96789-0123', '789.012.345-06'),
('Fernanda Silva', 'fernanda.silva@email.com', '123ferna', '(81) 97890-1234', '890.123.456-07'),
('Luciana Martins', 'luciana.martins@email.com', 'luci8na2', '(91) 98901-2345', '901.234.567-08'),
('Rafael Alves', 'rafael.alves@email.com', '65432198', '(11) 91234-9876', '012.345.678-09');


INSERT INTO notificacoes (mensagem, lida, id_usuarios) VALUES
('Mensagem 1', 0, 1),
('Mensagem 2', 1, 2),
('Mensagem 3', 0, 3),
('Mensagem 4', 1, 4),
('Mensagem 5', 0, 5),
('Mensagem 6', 1, 6),
('Mensagem 7', 0, 7),
('Mensagem 8', 1, 8),
('Mensagem 9', 0, 9),
('Mensagem 10', 1, 10);

 INSERT INTO areas (nome_area) VALUES 
('Engenharia Civil'),
('Arquitetura'),
('Topografia'),
('Geotecnia'),
('Hidráulica'),
('Saneamento'),
('Transportes'),
('Estruturas'),
('Construção Civil'),
('Planejamento Urbano');
